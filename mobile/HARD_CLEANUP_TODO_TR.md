# HARD CLEANUP TODO (TR) — WizyClubRN

Notlar:
- Kısıt: `Lütfen Kontrol Et/` ve repo root dosyalarına dokunulmayacak. Bu kapsama giren maddeler **KAPSAM DIŞI** olarak işaretlendi.
- Öncelik: Liste güvenli silmeleri öne alacak şekilde sıralandı. **Bağımlılık notları**, gerçek yürütme sırasını belirler.
- Format: Her madde **Kategori etiketi**, **dosya yolu**, **eylem**, **neden**, **risk**, **doğrulama**, **bağımlılık/not** içerir.

## Faz 1 — Güvenli Silmeler + Bariz Ölü Kod (Öncelik)
- [x] [DELETE] `mobile/src/presentation/hooks/useVideoPlayback.ts`, `mobile/src/presentation/hooks/useVideoSource.ts`: Kullanılmayan legacy playback hook’larını sil. Neden: pool tabanlı playback ile yerleri değişti; bakım yükü. Risk: low. Doğrulama: `rg -n "useVideoPlayback|useVideoSource" mobile/src` boş; `npx tsc --noEmit` geçer. Bağımlılık/Not: VideoLayer kaldırımı tamamlanmış olmalı.
- [x] [DELETE] `mobile/src/presentation/hooks/index.ts`: Kullanılmayan hooks barrel’ını sil. Neden: import yok; ölü exportları saklar. Risk: low. Doğrulama: `rg -n "presentation/hooks" mobile/src mobile/app` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [DELETE] `mobile/src/presentation/hooks/useDraftCleanup.ts`: Kullanılmayan hook’u sil. Neden: referans yok; bakım yüzeyi. Risk: low. Doğrulama: `rg -n "useDraftCleanup" mobile/src mobile/app` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [DELETE] `mobile/src/presentation/components/feed/FeedItemOverlay.tsx`: Kullanılmayan overlay bileşenini sil. Neden: referans yok; legacy UI. Risk: low. Doğrulama: `rg -n "FeedItemOverlay" mobile/src` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [DELETE] `mobile/src/presentation/components/feed/VideoOverlays.tsx`: Kullanılmayan overlay bileşenini sil. Neden: referans yok. Risk: low. Doğrulama: `rg -n "VideoOverlays" mobile/src` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [DELETE] `mobile/src/presentation/components/feed/BrightnessController.tsx`: Kullanılmayan controller’ı sil. Neden: referans yok. Risk: low. Doğrulama: `rg -n "BrightnessController" mobile/src` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [DELETE] `mobile/src/presentation/components/feed/SideOptionsSheet.tsx`: Kullanılmayan sheet’i sil. Neden: referans yok. Risk: low. Doğrulama: `rg -n "SideOptionsSheet" mobile/src` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [DELETE] `mobile/src/presentation/components/feed/index.ts`: Kullanılmayan feed barrel’ını sil. Neden: doğrudan importlar kullanılıyor. Risk: low. Doğrulama: `rg -n "components/feed" mobile/app mobile/src` barrel importu göstermiyor; `tsc` geçer. Bağımlılık/Not: none.
- [x] [DELETE] `mobile/src/presentation/components/shared/CustomRefreshScrollView.tsx`, `LoadingIndicator.tsx`, `RectangularStoryRing.tsx`: Kullanılmayan shared bileşenleri sil. Neden: referans yok. Risk: low. Doğrulama: `rg -n "CustomRefreshScrollView|LoadingIndicator|RectangularStoryRing" mobile/src` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [SIMPLIFY] `mobile/src/presentation/store/useActiveVideoStore.ts`: Kullanılmayan alan ve helper’ları kaldır (`preloadIndices`, `setPreloadIndices`, `useVideoPreloader`, `useShouldVideoPlay`). Neden: store yüzeyini küçültür, stale logic riskini azaltır. Risk: low. Doğrulama: `rg -n "preloadIndices|useVideoPreloader|useShouldVideoPlay" mobile/src` boş; `tsc` geçer. Bağımlılık/Not: none.
- [x] [SIMPLIFY] `mobile/src/presentation/components/feed/FeedManager.tsx`: `ScrollPlaceholder` içinde kullanılmayan `topInset` prop’unu kaldır. Neden: unused prop churn ve kafa karışıklığı üretir. Risk: low. Doğrulama: `tsc` ve runtime render değişmez. Bağımlılık/Not: none.
- [x] [DELETE] `backend/temp_uploads/*`: Takip edilen runtime artefaktlarını sil. Neden: repo gürültüsü ve güvenlik riski. Risk: low. Doğrulama: `git status` temiz; server runtime’da temp dosya yaratıyor. Bağımlılık/Not: root `.gitignore` değiştirilmeyecek; bunun yerine `backend/.gitignore` eklenmeli (root kısıtı).
- [x] [VERIFY] `mobile/src/presentation/components/discovery/*`: Kullanım olmadığını doğrula, ardından sil. Neden: klasör dışında import bulunmadı. Risk: medium. Doğrulama: `rg -n "MorphingDiscoveryBar|MorphedTabView|MorphBlurView|BouncyPressable" mobile/src mobile/app` boş + ekranlarda dinamik kullanım yok. Bağımlılık/Not: doğrulama sonrası sil.
- [x] [VERIFY] Deals domain yığını: `mobile/src/domain/usecases/GetDealsUseCase.ts`, `mobile/src/domain/repositories/IDealRepository.ts`, `mobile/src/data/repositories/DealRepositoryImpl.ts`, `mobile/src/data/datasources/MockDealDataSource.ts`: Kullanım olmadığını doğrula, sonra sil. Neden: app tarafında kullanılmıyor görünüyor. Risk: medium. Doğrulama: `rg -n "GetDealsUseCase|DealRepositoryImpl|MockDealDataSource" mobile/src mobile/app` boş; deals ekranı bozulmuyor. Bağımlılık/Not: doğrulama sonrası sil.
- [x] [VERIFY] User profile domain yığını: `mobile/src/domain/usecases/GetUserProfileUseCase.ts`, `mobile/src/domain/repositories/IUserRepository.ts`, `mobile/src/data/repositories/UserRepositoryImpl.ts`: Kullanım olmadığını doğrula, sonra sil. Neden: import görünmüyor. Risk: medium. Doğrulama: `rg -n "GetUserProfileUseCase|UserRepositoryImpl|IUserRepository" mobile/src mobile/app` boş; profil akışları çalışır. Bağımlılık/Not: doğrulama sonrası sil.

## Faz 0 — Güvenlik ve Baseline
- [ ] [DOC] `BACKEND_SETUP_GUIDE.md`, `mobile/` run docs: Baseline run/build komutlarını dokümante et. Neden: temizlik tekrar edilebilir run’lara dayanmalı. Risk: low. Doğrulama: dokümante adımlar temiz makinede çalışır. Bağımlılık/Not: **KAPSAM DIŞI** (root dosyası); alternatif olarak `backend/docs/` ve `mobile/docs/` altında yeni doküman oluştur.
- [ ] [TEST] `mobile/src/presentation/components/feed/FeedManager.tsx`, `VideoPlayerPool.tsx`: Feed/video smoke checklist tanımla. Neden: sessiz regresyonları önler. Risk: low. Doğrulama: manuel çalıştır + beklenen davranış ekran kaydı. Bağımlılık/Not: none.
- [ ] [VERIFY] `mobile/src/core/services/PerformanceLogger.ts`, `mobile/app/_layout.tsx`: Baseline performans kontrol noktalarını kaydet. Neden: perf regresyonu riskini görünür kılar. Risk: medium. Doğrulama: log kayıtları dokümana işlendi. Bağımlılık/Not: none.

## Faz 2 — Konsolidasyon + Yüzey Alanı Azaltma
- [ ] [REFACTOR] `mobile/src/presentation/contexts/ThemeContext.tsx`, `mobile/src/presentation/store/useThemeStore.ts` ve tüm tüketiciler: Tema sahipliğini tek noktada birleştir. Neden: çift sahiplik drift ve bug riski. Risk: medium. Doğrulama: tema değişimi ve dark/light UI tablar arası tutarlı. Bağımlılık/Not: Faz 1 tamamlanmalı.
- [ ] [REFACTOR] `mobile/src/presentation/components/feed/ActiveVideoOverlay.tsx`, `MetadataLayer.tsx`, `ActionButtons.tsx`: Prop yüzeyini azalt, state/aksiyonları hook veya context ile grupla. Neden: coupling ve regresyon riski. Risk: medium. Doğrulama: overlay aksiyonları çalışır, UI doğru güncellenir. Bağımlılık/Not: Faz 1 tamamlanmalı.
- [ ] [REFACTOR] `mobile/src/presentation/components/explore/TrendingCarousel.tsx`, `mobile/src/data/services/FeedPrefetchService.ts`: Cache/prefetch sahipliğini tek serviste konsolide et. Neden: duplikasyon tutarsız UX yaratır. Risk: medium. Doğrulama: prefetch davranışı feed ile aynı; cache hit’ler korunur. Bağımlılık/Not: Faz 1 tamamlanmalı.
- [ ] [DOC] `mobile/LOGGING_GUIDE.md`, `mobile/LOGLAMA_KILAVUZU.md`: Tek kanonik logging dokümanı oluştur; çevirileri tek yerde tut. Neden: doküman drift’i önler. Risk: low. Doğrulama: tek doküman ve referanslar güncel. Bağımlılık/Not: Faz 1 tamamlanmalı.
- [ ] [DOC] `Lütfen Kontrol Et/`: Arşiv dokümanlarını `docs/archive/` altına taşı ve index ekle. Neden: repo kökünde doküman dağınıklığı. Risk: low. Doğrulama: index üzerinden erişim. Bağımlılık/Not: **KAPSAM DIŞI** (Lütfen Kontrol Et klasörü).
- [ ] [SIMPLIFY] `backend/` root scriptleri ve `maintenance_scripts/`: `backend/scripts/` altında tek CLI ile konsolide et. Neden: script dağınıklığı. Risk: medium. Doğrulama: kritik bakım işleri çalışır. Bağımlılık/Not: Faz 1 tamamlanmalı; root düzeyinde klasör hareketi gerektirir.
- [ ] [SIMPLIFY] `backend/*.sql`: `backend/migrations/` altında tutarlı isimlendirme ve README ile taşı. Neden: SQL dağınıklığı. Risk: medium. Doğrulama: migration talimatları güncel ve yollar doğru. Bağımlılık/Not: Faz 1 tamamlanmalı.

## Faz 3 — Yapısal Refactorlar (Sahiplik Sınırları)
- [ ] [REFACTOR] `mobile/src/presentation/components/feed/FeedManager.tsx`: Modüllere böl (scroll, overlay, interactions, prefetch). Neden: god component hataları gizler ve iterasyonu yavaşlatır. Risk: high. Doğrulama: tam feed smoke test + scroll regresyonu yok. Bağımlılık/Not: Faz 2 tamamlanmalı.
- [ ] [REFACTOR] `mobile/src/presentation/components/feed/VideoPlayerPool.tsx` + store: Playback/state için tek lifecycle owner oluştur. Neden: çoklu doğruluk kaynağı desync riski. Risk: high. Doğrulama: hızlı scroll’da audio leak/yanlış video yok. Bağımlılık/Not: Faz 2 tamamlanmalı.
- [ ] [REFACTOR] `backend/server.js`: Route modülleri, middleware ve servisler olarak böl. Neden: tek dosya backend denetimi zorlaştırır. Risk: high. Doğrulama: API endpoint’leri ve HLS pipeline çalışır. Bağımlılık/Not: Faz 2 tamamlanmalı.
- [ ] [REFACTOR] `backend/services/HlsService.js` + R2 scriptleri: R2 operasyonlarını tek modülde merkezileştir. Neden: duplikasyon veri bütünlüğü riski. Risk: medium. Doğrulama: HLS upload ve cleanup scriptleri çalışır. Bağımlılık/Not: Faz 2 tamamlanmalı.

## Faz 4 — Hardening (Risk + Regresyon Kontrolü)
- [ ] [TEST] `mobile/` feed ve video akışları: Tekrarlanabilir smoke test script’i ekle ve CI’ye koy. Neden: refactorlar doğrulama olmadan riskli. Risk: medium. Doğrulama: CI veya local’de tutarlı sonuç. Bağımlılık/Not: Faz 3 tamamlanmalı.
- [ ] [TEST] `backend/`: Upload endpoint’leri ve HLS pipeline için entegrasyon kontrolleri ekle. Neden: backend temizliği video pipeline’ı bozabilir. Risk: medium. Doğrulama: upload/HLS endpoint’leri başarılı. Bağımlılık/Not: Faz 3 tamamlanmalı.
- [ ] [DEPENDENCY] `backend/package.json`: Kullanılmıyorsa `aws-sdk` (v2) kaldır. Neden: dependency yüzeyini azaltır. Risk: low. Doğrulama: `rg -n "aws-sdk" backend` boş; server çalışır. Bağımlılık/Not: Faz 1 tamamlanmalı.
- [ ] [DEPENDENCY] `mobile/package.json`: Kullanılmayan bağımlılıkları kaldır (Dependency Hygiene listesine göre). Neden: build boyutu ve native config riski azalır. Risk: medium. Doğrulama: `npx depcheck`, `npx expo-doctor`, `npx tsc --noEmit`, app boot. Bağımlılık/Not: Faz 1 tamamlanmalı.
- [ ] [VERIFY] `mobile/src/presentation/store/useThemeStore.ts`: `Appearance.addChangeListener` için kontrollü lifecycle + cleanup ekle. Neden: listener leak riski. Risk: low. Doğrulama: tema değişimleri hâlâ çalışır. Bağımlılık/Not: Faz 2 tamamlanmalı.
